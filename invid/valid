

  validation {
    condition = alltrue([
      for config in var.access_config : 
      (
        config.authentication_mode == "CONFIG_MAP" || 
        config.authentication_mode == "API" || 
        config.authentication_mode == "API_AND_CONFIG_MAP"
      ) &&
      (config.bootstrap_cluster_admin_permission == true || config.bootstrap_cluster_admin_permission == false)
    ])
    error_message = "authentication_mode must be 'CONFIG_MAP', 'API', or 'API_AND_CONFIG_MAP', and bootstrap_cluster_admin_permission must be true or false."
  }

#version 
variable "cluster_version" {
  description = "Kubernetes <major>.<minor> version to use for the EKS cluster (i.e.: 1.27)"
  type        = string
  default     = null

  validation {
    condition     = can(regex("^\\d+\\.\\d+$", var.cluster_version)) && (var.cluster_version != "")
    error_message = "Cluster version must be in the format <major>.<minor> (e.g., '1.27')."
  }
}

#timeout 
validation {
    condition = alltrue([
      for key, value in var.timeout : 
        (key == "create" || key == "update" || key == "delete") &&
        can(regex("^\\d+[smhdwMy]?$", value))
    ])
    error_message = "Each timeout value must be in a valid duration format (e.g., '30m', '1h', '2d') for create, update, and delete keys."
  }
